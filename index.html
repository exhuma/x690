
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Welcome to x690’s documentation! &#8212; x690 0.3.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Changelog" href="changelog.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="welcome-to-x690-s-documentation">
<h1>Welcome to x690’s documentation!<a class="headerlink" href="#welcome-to-x690-s-documentation" title="Permalink to this headline">¶</a></h1>
<p>Repository: <a class="reference external" href="https://github.com/exhuma/x690">https://github.com/exhuma/x690</a></p>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/modules.html">API Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>
</div>
</div>
<div class="section" id="pure-python-x-690-implementation">
<h1>Pure Python <a class="reference external" href="https://www.itu.int/rec/recommendation.asp?lang=en&amp;parent=T-REC-X.690-201508-I">X.690</a> implementation<a class="headerlink" href="#pure-python-x-690-implementation" title="Permalink to this headline">¶</a></h1>
<img alt="Build &amp; Publish Docs" src="https://github.com/exhuma/x690/workflows/Build%20&amp;%20Publish%20Docs/badge.svg?branch=main" />
<p>This module contains a pure Python implementation of the “x690” standard for
BER encoding/decoding. Other encodings are currently unsupported but
pull-requests are welcome.</p>
<div class="section" id="supporting-new-types">
<h2>Supporting New Types<a class="headerlink" href="#supporting-new-types" title="Permalink to this headline">¶</a></h2>
<p>Some applications may need to support types which are not defined in the X.690
standard. This is supported by this library but the types must be defined and
registered.</p>
<p>To register a type, simply subclass <code class="docutils literal notranslate"><span class="pre">x690.types.Type</span></code>. This will take care of
the registration. Make sure that your new type is imported before using it.</p>
<p>New types should define the following 3 class-variables:</p>
<dl class="simple">
<dt><strong>TYPECLASS</strong></dt><dd><p>A value from <code class="docutils literal notranslate"><span class="pre">x690.util.TypeClass</span></code></p>
</dd>
<dt><strong>NATURE</strong></dt><dd><p>A value from <code class="docutils literal notranslate"><span class="pre">x690.util.TypeNature</span></code></p>
</dd>
<dt><strong>TAG</strong></dt><dd><p>A numerical identifier for the type</p>
</dd>
</dl>
<p>Refer to the x690 standard for more details on these values. As a general
rule-of-thumb you can assume that the class is either “context” or
“application” (it might be good to keep the “universal” class reserved for
x690). The nature should be “primitive” for simple values and “constructed” for
composed types. The tag is free to choose as long as you don’t overlap with an
existing type.</p>
<p>To convert raw-bytes into a Python object, override <code class="docutils literal notranslate"><span class="pre">x690.Type.decode_raw</span></code>
and conversely also <code class="docutils literal notranslate"><span class="pre">x690.Type.encode_raw</span></code>. Refer to the docstrings for more
details.</p>
</div>
<div class="section" id="reverse-engineering-bytes">
<h2>Reverse Engineering Bytes<a class="headerlink" href="#reverse-engineering-bytes" title="Permalink to this headline">¶</a></h2>
<p>All types defined in the <code class="docutils literal notranslate"><span class="pre">x690</span></code> library provide a <code class="docutils literal notranslate"><span class="pre">.pretty()</span></code> method which
returns a prettyfied string.</p>
<p>If you are confronted with a bytes-object encoded using X.690 but don’t have
any documentation, you can write the following loop:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">x690</span> <span class="kn">import</span> <span class="n">decode</span>

<span class="n">data</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;mydatafile.bin&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<span class="n">value</span><span class="p">,</span> <span class="n">nxt</span> <span class="o">=</span> <span class="n">decode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">pretty</span><span class="p">())</span>

<span class="k">while</span> <span class="n">nxt</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">value</span><span class="p">,</span> <span class="n">nxt</span> <span class="o">=</span> <span class="n">decode</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">nxt</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">pretty</span><span class="p">())</span>
</pre></div>
</div>
<p>This should get you started.</p>
<p>If the data contain non-standard types, they will get detected as “UnknownType”
and will print out the type-class, nature and tag in the pretty-printed block.</p>
<p>This will allow you to define your own subclass of <code class="docutils literal notranslate"><span class="pre">x690.types.Type</span></code> using
those values. Override <code class="docutils literal notranslate"><span class="pre">decode(...)</span></code> in that class to handle the unknown
type.</p>
</div>
</div>
<div class="section" id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="encoding-to-bytes">
<h2>Encoding to bytes<a class="headerlink" href="#encoding-to-bytes" title="Permalink to this headline">¶</a></h2>
<p>Encoding to bytes can be done by simply calling the Python builting <code class="docutils literal notranslate"><span class="pre">bytes()</span></code>
on instances from <code class="docutils literal notranslate"><span class="pre">x690.types</span></code>:</p>
<div class="section" id="encoding-of-a-single-value">
<h3>Encoding of a single value<a class="headerlink" href="#encoding-of-a-single-value" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">x690.types</span> <span class="k">as</span> <span class="nn">t</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myvalue</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asbytes</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">myvalue</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">repr</span><span class="p">(</span><span class="n">asbytes</span><span class="p">)</span>
<span class="go">b&#39;\x02\x01\x0c&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="encoding-of-a-composite-value-using-sequence">
<h3>Encoding of a composite value using Sequence<a class="headerlink" href="#encoding-of-a-composite-value-using-sequence" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">x690.types</span> <span class="k">as</span> <span class="nn">t</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myvalue</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">Sequence</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">t</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">t</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">t</span><span class="o">.</span><span class="n">Integer</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">asbytes</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">myvalue</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">repr</span><span class="p">(</span><span class="n">asbytes</span><span class="p">)</span>
<span class="go">b&#39;0\t\x02\x01\x0c\x02\x01\x0c\x02\x01\x0c&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="decoding-from-bytes">
<h3>Decoding from bytes<a class="headerlink" href="#decoding-from-bytes" title="Permalink to this headline">¶</a></h3>
<p>Decode bytes by calling <code class="docutils literal notranslate"><span class="pre">x690.types.decode</span></code> on your byte data. This will
return a tuple where the first value contains the decoded object, and the
second one will contain any remaining bytes which were not decoded.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">x690</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;0</span><span class="se">\t\x02\x01\x0c\x02\x01\x0c\x02\x01\x0c</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decoded</span><span class="p">,</span> <span class="n">nxt</span> <span class="o">=</span> <span class="n">x690</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decoded</span>
<span class="go">Sequence(Integer(12), Integer(12), Integer(12))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nxt</span>
<span class="go">11</span>
</pre></div>
</div>
</div>
<div class="section" id="type-hinting-enforcing">
<h3>Type-Hinting &amp; Enforcing<a class="headerlink" href="#type-hinting-enforcing" title="Permalink to this headline">¶</a></h3>
<p><strong>New in 0.3.0</strong></p>
<p>When decoding bytes, it is possible to specify an expcted type which does two
things: Firstly, it tells tools like <code class="docutils literal notranslate"><span class="pre">mypy</span></code> what the return type will be and
secondly, it runs an internal type-check which <em>ensures</em> that the returned
value is of the expected type. <code class="docutils literal notranslate"><span class="pre">x690.exc.UnexpectedType</span></code> is raised otherwise.</p>
<p>This does of course only work if you know the type in advance.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">x690</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">x690.types</span> <span class="k">as</span> <span class="nn">t</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;0</span><span class="se">\t\x02\x01\x0c\x02\x01\x0c\x02\x01\x0c</span><span class="s1">&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decoded</span><span class="p">,</span> <span class="n">nxt</span> <span class="o">=</span> <span class="n">x690</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">enforce_type</span><span class="o">=</span><span class="n">t</span><span class="o">.</span><span class="n">Sequence</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decoded</span>
<span class="go">Sequence(Integer(12), Integer(12), Integer(12))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nxt</span>
<span class="go">11</span>
</pre></div>
</div>
</div>
<div class="section" id="strict-decoding">
<h3>Strict Decoding<a class="headerlink" href="#strict-decoding" title="Permalink to this headline">¶</a></h3>
<p><strong>New in 0.3.0</strong></p>
<p>When decoding using <code class="docutils literal notranslate"><span class="pre">decode</span></code> and you don’t expect any remaining bytes, use
<code class="docutils literal notranslate"><span class="pre">strict=True</span></code> which will raise <code class="docutils literal notranslate"><span class="pre">x690.exc.IncompleteDecoding</span></code> if there’s any
remaining data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">x690</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;0</span><span class="se">\t\x02\x01\x0c\x02\x01\x0c\x02\x01\x0c</span><span class="s1">junk-bytes&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">decoded</span><span class="p">,</span> <span class="n">nxt</span> <span class="o">=</span> <span class="n">x690</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  <span class="c">...</span>
<span class="gr">x690.exc.IncompleteDecoding</span>: <span class="n">Strict decoding still had 10 remaining bytes!</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="#">x690</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/modules.html">API Docs</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
      <li>Next: <a href="changelog.html" title="next chapter">Changelog</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Michel Albert.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>